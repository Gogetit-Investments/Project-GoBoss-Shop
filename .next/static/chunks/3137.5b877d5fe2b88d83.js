"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3137],{93137:function(e,t,s){s.r(t),s.d(t,{default:function(){return _}});var r=s(85893),a=s(74231),n=s(74931),i=s(10606),o=s(5897),l=s(32250),c=s(14685),d=s(55335),u=s(17038),m=s(67294),x=function(){var e,t={},s=[],r="__LSM__";try{e="undefined"!=typeof sessionStorage?window.sessionStorage:{}}catch(t){e={}}return{updateStore:function(s){try{t=JSON.parse(e.getItem(r)||"")||s}catch(e){t=s}},saveStore:function(){e.setItem(r,JSON.stringify(t))},get middleWares(){return s},set middleWares(e){s=e},get state(){return t},set state(e){t=e},get name(){return r},set name(e){r=e},get storageType(){return e},set storageType(t){e=t}}}(),p=m.createContext(void 0),g=function(e){var t=e.children,s=m.useState(x.state);return m.createElement(p.Provider,{value:{state:s[0],setState:s[1]}},t)},f="onAction";var v=s(28763),k=s(88767),h=s(10268);function b(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function j(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{},r=Object.keys(s);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(s).filter((function(e){return Object.getOwnPropertyDescriptor(s,e).enumerable})))),r.forEach((function(t){b(e,t,s[t])}))}return e}var S=a.Ry().shape({email:a.Z_().email().required()}),N=a.Ry().shape({token:a.Z_().required()}),w=a.Ry().shape({password:a.Z_().required()});function y(e){var t=e.email,s=e.serverError,a=e.onSubmit,n=e.isLoading,l=(0,h.$G)("common").t,m=(0,d.SO)().openModal;return(0,r.jsxs)("div",{className:"bg-light px-6 pt-10 pb-8 dark:bg-dark-300 sm:px-8 lg:p-12",children:[(0,r.jsx)(u.i,{className:"absolute bottom-0 left-0 text-light dark:text-dark-300 dark:opacity-60"}),(0,r.jsx)("div",{className:"relative z-10 flex items-center",children:(0,r.jsxs)("div",{className:"w-full shrink-0 text-left md:w-[380px]",children:[(0,r.jsxs)("div",{className:"flex flex-col pb-5 text-center lg:pb-9 xl:pb-10 xl:pt-2",children:[(0,r.jsx)("h2",{className:"text-lg font-medium tracking-[-0.3px] text-dark dark:text-light lg:text-xl",children:l("text-reset-password")}),(0,r.jsx)("div",{className:"mt-1.5 text-13px leading-6 tracking-[0.2px] dark:text-light-900 lg:mt-2.5 xl:mt-3",children:l("text-reset-password-title")})]}),(0,r.jsx)(i.l,{onSubmit:a,useFormProps:{defaultValues:{email:t}},serverError:s,validationSchema:S,className:"text-left",children:function(e){var t,s=e.register,a=e.formState.errors;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(o.Z,j({label:"contact-us-email-field",type:"email"},s("email"),{error:(null===(t=a.email)||void 0===t?void 0:t.message)&&"text-email-notice"})),(0,r.jsx)(c.Z,{type:"submit",className:"!mt-5 w-full text-sm tracking-[0.2px] lg:!mt-6",isLoading:n,disabled:n,children:l("text-reset-password-submit")})]})}}),(0,r.jsx)("div",{className:"relative mt-10 flex items-center justify-center border-t border-light-500 text-13px dark:border-dark-600",children:(0,r.jsx)("span",{className:"absolute inline-flex bg-light px-2 pb-0.5 dark:bg-dark-300",children:l("text-or")})}),(0,r.jsxs)("div",{className:"pt-7 text-center text-13px",children:[l("text-back-to")," ",(0,r.jsx)("button",{type:"button",className:"font-semibold text-brand hover:text-dark-400 hover:dark:text-light-500",onClick:function(){return m("LOGIN_VIEW")},children:l("text-login")})]})]})})]})}function E(e){var t=e.token,s=e.message,a=e.serverError,n=e.onSubmit,l=e.isLoading,d=e.onBack;return(0,r.jsxs)("div",{className:"px-6 pt-10 pb-8 sm:px-8 lg:p-12",children:[(0,r.jsx)(u.i,{className:"absolute bottom-0 left-0 text-light dark:text-dark-300 dark:opacity-60"}),(0,r.jsxs)("div",{className:"relative z-10",children:[s&&(0,r.jsxs)("div",{className:"flex flex-col pb-5 text-center lg:pb-9 xl:pb-10 xl:pt-2",children:[(0,r.jsx)("h2",{className:"text-lg font-medium tracking-[-0.3px] text-dark dark:text-light lg:text-xl",children:"Check Your Email"}),(0,r.jsx)("div",{className:"mt-1.5 text-13px leading-6 tracking-[0.2px] dark:text-light-900 lg:mt-2.5 xl:mt-3",children:"We sent you a token to reset your password"})]}),(0,r.jsx)(i.l,{onSubmit:n,useFormProps:{defaultValues:{token:t}},validationSchema:N,serverError:a,children:function(e){var t,s=e.register,a=e.formState.errors;return(0,r.jsxs)("div",{className:"w-full xs:w-[380px]",children:[(0,r.jsx)(o.Z,j({label:"Enter Token"},s("token"),{error:(null===(t=a.token)||void 0===t?void 0:t.message)&&"Invalid token",className:"text-left"})),(0,r.jsxs)("div",{className:"mt-7 grid grid-cols-2 gap-5 text-13px",children:[(0,r.jsx)(c.Z,{type:"reset",variant:"outline",onClick:d,children:"Back"}),(0,r.jsx)(c.Z,{type:"submit",isLoading:l,disabled:l,children:"Verify Token"})]})]})}})]})]})}function P(e){var t=e.onSubmit,s=e.isLoading,a=e.onBack;return(0,r.jsxs)("div",{className:"px-6 pt-10 pb-8 sm:px-8 lg:p-12",children:[(0,r.jsx)(u.i,{className:"absolute bottom-0 left-0 text-light dark:text-dark-300 dark:opacity-60"}),(0,r.jsxs)("div",{className:"relative z-10",children:[(0,r.jsxs)("div",{className:"flex flex-col pb-5 text-center lg:pb-9 xl:pb-10 xl:pt-2",children:[(0,r.jsx)("h2",{className:"text-lg font-medium tracking-[-0.3px] text-dark dark:text-light lg:text-xl",children:"Reset Password"}),(0,r.jsx)("div",{className:"mt-1.5 text-13px leading-6 tracking-[0.2px] dark:text-light-900 lg:mt-2.5 xl:mt-3",children:"Almost there to reset your password"})]}),(0,r.jsx)(i.l,{onSubmit:t,useFormProps:{defaultValues:{password:""}},validationSchema:w,children:function(e){var t,n=e.register,i=e.formState.errors;return(0,r.jsxs)("div",{className:"w-full xs:w-[380px]",children:[(0,r.jsx)(l.Z,j({label:"New Password"},n("password"),{error:null===(t=i.password)||void 0===t?void 0:t.message,className:"text-left"})),(0,r.jsxs)("div",{className:"mt-7 grid grid-cols-2 gap-5 text-13px",children:[(0,r.jsx)(c.Z,{type:"reset",variant:"outline",onClick:a,children:"Back"}),(0,r.jsx)(c.Z,{type:"submit",isLoading:s,disabled:s,children:"Send"})]})]})}})]})]})}function O(){var e=function(e){W.updateFormState({step:e})},t=(0,d.SO)().openModal,s=(0,m.useState)(null),a=s[0],i=s[1],o=(0,m.useState)(null),l=o[0],c=o[1],u=(0,k.useMutation)(v.Z.users.forgotPassword),g=u.mutate,h=u.isLoading,b=(0,k.useMutation)(v.Z.users.verifyForgotPasswordToken),S=b.mutate,N=b.isLoading,w=(0,k.useMutation)(v.Z.users.resetPassword),O=w.mutate,_=w.isLoading,T=function(e){var t=m.useContext(p),s=t.state,r=t.setState,a=m.useRef(Object.entries(e||{}).reduce((function(e,t){var s;return Object.assign({},e,((s={})[t[0]]=function(e,t){return function(s){x.state=t(x.state,s),x.middleWares&&(x.state=x.middleWares.reduce((function(e,r){return r(e,t.name,s)||e}),x.state)),e(x.state),"onAction"===f&&x.saveStore()}}(r,t[1]),s))}),{}));return m.useEffect((function(){"beforeUnload"===f&&(window.onbeforeunload=function(){return x.saveStore()})}),[]),{actions:a.current,state:s}}({updateFormState:Z}),F=T.state,W=T.actions;return(0,r.jsxs)("div",{children:["Email"===F.step&&(0,r.jsx)(y,{email:F.email,onSubmit:function(e){var t=e.email;g({email:t},{onSuccess:function(e){e.success?(i(e.message),W.updateFormState({email:t,step:"Token"})):c({email:e.message})}})},serverError:l,isLoading:h}),"Token"===F.step&&(0,r.jsx)(E,{token:F.token,onSubmit:function(e){var t=e.token;S({token:t,email:F.email},{onSuccess:function(e){e.success?W.updateFormState({step:"Password",token:t}):c({token:e.message})}})},message:a,serverError:l,isLoading:N,onBack:function(){return e("Email")}}),"Password"===F.step&&(0,r.jsx)(P,{onSubmit:function(e){var s=e.password;O({password:s,token:F.token,email:F.email},{onSuccess:function(e){e.success&&(W.updateFormState(j({},L)),n.ZP.success((0,r.jsx)("b",{children:"Password successfully reset!"}),{className:"-mt-10 xs:mt-0"}),t("LOGIN_VIEW"))}})},isLoading:_,onBack:function(){return e("Token")}})]})}var L={step:"Email",email:"",password:"",token:""};!function(e,t){t&&(t.name&&(x.name=t.name),t.storageType&&(x.storageType=t.storageType),t.middleWares&&(x.middleWares=t.middleWares),t.persist&&(f=t.persist)),x.updateStore(e)}(L);var Z=function(e,t){return j({},e,t)};function _(){return(0,r.jsx)(g,{children:(0,r.jsx)(O,{})})}}}]);